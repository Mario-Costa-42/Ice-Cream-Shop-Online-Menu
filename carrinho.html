<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="carrinho.css" />
</head>
<body>
    <a href="./menu.html">
      <img src="./assets/arrow_back.svg" alt="Início" id="home" />
    </a>
  <h1>🛒 Carrinho</h1>
  <div id="carrinho"></div>

  <script>
    function carregarCarrinho() {
      let carrinho = JSON.parse(localStorage.getItem("carrinho")) || [];
      let container = document.getElementById("carrinho");
      container.innerHTML = ""; // limpa antes de renderizar de novo

      if (carrinho.length > 0) {
        let totalGeral = 0;

        carrinho.forEach((item, index) => {
          let divItem = document.createElement("div");
          divItem.style.border = "1px solid #ccc";
          divItem.style.padding = "10px";
          divItem.style.margin = "10px 0";
          divItem.style.borderRadius = "8px";
          divItem.style.display = "flex";
          divItem.style.justifyContent = "space-between";
          divItem.style.alignItems = "center";

          let descricao = "";

          if (item.produto === "Milkshake") {
            descricao = `${item.produto} - ${item.nome} x${item.quantidade} = R$ ${item.subtotal.toFixed(2).replace(".", ",")}`;
          } else if (item.produto === "Açaí") {
            let extras = item.extras.map(e => `${e.nome} (+R$ ${e.preco.toFixed(2).replace(".", ",")})`).join(", ");
            descricao = `${item.produto} ${item.tamanho} - Coberturas: ${item.coberturas.join(", ")} - Acompanhamentos: ${item.acompanhamentos.join(", ")} - Extras: ${extras || "Nenhum"} = R$ ${item.subtotal.toFixed(2).replace(".", ",")}`;
          }

          let span = document.createElement("span");
          span.textContent = descricao;

          let btnRemover = document.createElement("button");
          btnRemover.textContent = "❌ Remover";
          btnRemover.style.marginLeft = "10px";
          btnRemover.style.background = "#ff4d4d";
          btnRemover.style.color = "#fff";
          btnRemover.style.border = "none";
          btnRemover.style.padding = "5px 10px";
          btnRemover.style.cursor = "pointer";
          btnRemover.style.borderRadius = "6px";

          btnRemover.onclick = () => {
            removerItem(index);
          };

          divItem.appendChild(span);
          divItem.appendChild(btnRemover);
          container.appendChild(divItem);

          totalGeral += item.subtotal;
        });

        let totalP = document.createElement("h2");
        totalP.textContent = "Total: R$ " + totalGeral.toFixed(2).replace(".", ",");
        container.appendChild(totalP);
      } else {
        container.textContent = "Carrinho vazio.";
      }
    }

    function removerItem(index) {
      let carrinho = JSON.parse(localStorage.getItem("carrinho")) || [];
      carrinho.splice(index, 1); // remove o item da posição escolhida
      localStorage.setItem("carrinho", JSON.stringify(carrinho));
      carregarCarrinho(); // recarrega a lista
    }

    carregarCarrinho();
  </script>


</body>
</html>